# Occupation Risk Assessment Generator

This project uses the OpenAI API to generate risk assessment information for different occupations based on ANZSIC codes and descriptions. The generated information includes:

1. **Drivers of Claims**: Key risk factors and liability exposures associated with the occupation.
2. **Significant International Losses**: Examples of notable liability cases from around the world (excluding Australia).
3. **Significant Australian Losses**: Examples of notable liability cases specifically from Australia.
4. **Class Action Description**: Information about class actions in Australia related to the occupation (if available).

## Purpose

This tool is designed to assist underwriters in the corporate liability insurance sector by providing them with relevant information about risk factors and historical loss examples for different occupations. This information can help underwriters make more informed decisions when pricing insurance policies.

## Requirements

- Python 3.6+
- Required packages:
  - pandas
  - openpyxl
  - openai

You can install the required packages using pip:

```bash
pip install pandas openpyxl openai
```

## Usage

### Setting up your OpenAI API Key

Before using the script, you need to set up your OpenAI API key. You can do this in two ways:

1. Set it as an environment variable:
   ```bash
   # For Windows
   set OPENAI_API_KEY=your_api_key_here
   
   # For macOS/Linux
   export OPENAI_API_KEY=your_api_key_here
   ```

2. Pass it directly to the script using the `--api_key` argument.

### Running the Script

#### With an Input File

To process multiple occupations from an input Excel file:

```bash
python generate_occupation_data.py --input sample_input.xlsx --output generated_results.xlsx
```

The input file should be an Excel file with at least two columns:
- `ANSZIC Code`: The ANZSIC code for the occupation
- `Description`: The description of the occupation

#### Manual Input

If you don't provide an input file, the script will prompt you to enter an ANZSIC code and description manually:

```bash
python generate_occupation_data.py --output generated_results.xlsx
```

### Additional Options

- `--model`: Specify which OpenAI model to use (default: 'gpt-4o')
- `--sample`: Path to a sample data file for reference (default: 'VSL Data for ChatGPT v2.xlsx')

## Sample Files

- `sample_input.py`: Script to generate a sample input file with ANZSIC codes and descriptions
- `sample_input.xlsx`: Sample input file generated by the script
- `VSL Data for ChatGPT v2.xlsx`: Reference data file with examples of the desired output format

## Output

The script generates an Excel file with the following columns:
- `ANSZIC Code`: The ANZSIC code for the occupation
- `Description`: The description of the occupation
- `Drivers`: Potential drivers of claims for the occupation
- `Significant Losses International`: Examples of significant international losses
- `Significant Losses Australian`: Examples of significant Australian losses
- `Class Action Description`: Information about class actions in Australia related to the occupation (if available)

Each entry in the `Drivers`, `Significant Losses International`, `Significant Losses Australian`, and `Class Action Description` columns is formatted as a bulleted list with each point starting with an asterisk (*). If no class action information is found for an occupation, the corresponding cell will be left blank.

## Notes

- The script includes delays between API calls to avoid rate limiting.
- The generated information is based on the OpenAI model's knowledge and may need to be reviewed for accuracy.
- The quality of the generated information depends on the specificity of the occupation description. 
- The class action information is specifically focused on Australian cases and will be left blank if no relevant information is found. 